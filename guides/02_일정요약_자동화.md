# ë‚˜ë§Œì˜ ì¼ì • ìš”ì•½ ìë™í™”

## í”„ë¡œê·¸ë¨ ì†Œê°œ

ì´ í”„ë¡œê·¸ë¨ì€ **Google ìº˜ë¦°ë”ì˜ ì˜¤ëŠ˜ ì¼ì •ì„ ê°€ì ¸ì™€ OpenAI GPT ëª¨ë¸ë¡œ ìš”ì•½í•˜ê³ , ê·¸ ê²°ê³¼ë¥¼ Telegram ë©”ì‹œì§€ë¡œ ì „ì†¡í•˜ëŠ” Google Apps Script**ì…ë‹ˆë‹¤.
ë§¤ì¼ ì•„ì¹¨ ìë™ìœ¼ë¡œ ì˜¤ëŠ˜ì˜ ì¼ì •ì„ ê°„ë‹¨í•˜ê³  ì¹œì ˆí•œ ë©”ì‹œì§€ë¡œ ë°›ì•„ë³´ê³  ì‹¶ë‹¤ë©´ ì´ ìŠ¤í¬ë¦½íŠ¸ë¥¼ í™œìš©í•´ë³´ì„¸ìš”.

### ë°ëª¨
![explorer_BOWn4pzWxM](https://github.com/user-attachments/assets/60956322-fff9-4d8c-bb67-054554f4379e)

---

## ì‹¤í–‰ ë°©ë²•

### 1. ê°ì¢… í‚¤ ì…ë ¥

* **TELEGRAM\_TOKEN**: ë´‡ í† í°ì„ [ì´ ê°€ì´ë“œ](https://github.com/dabidstudio/dabidstudio_guides/blob/main/get_telegram_token.md)ë¥¼ ë”°ë¼ ë°œê¸‰ë°›ê³  ì—¬ê¸°ì— ë¶™ì—¬ë„£ê¸°
* **TELEGRAM\_CHAT\_ID**: ì•„ë˜ "CHAT ID í™•ì¸ ë°©ë²•" ì°¸ê³ 
* **OPENAI\_API\_KEY**: [OpenAI í‚¤ ë°œê¸‰ ê°€ì´ë“œ](https://github.com/dabidstudio/dabidstudio_guides/blob/main/get-openai-api-key.md)ë¥¼ ì°¸ê³ í•˜ì—¬ API í‚¤ ë°œê¸‰ í›„ ì…ë ¥

#### CHAT ID í™•ì¸ ë°©ë²•

1. í…”ë ˆê·¸ë¨ì—ì„œ ìƒì„±í•œ ë´‡ì—ê²Œ ì•„ë¬´ ë©”ì‹œì§€ ë³´ë‚´ê¸°

2. ì•„ë˜ ì£¼ì†Œ ì ‘ì† (ë´‡ í† í° ì…ë ¥)

   ```
   https://api.telegram.org/bot<ë´‡_í† í°>/getUpdates
   ```

   ì˜ˆ: `https://api.telegram.org/bot123456789:ABCxyz/getUpdates`

3. JSON ì‘ë‹µì—ì„œ `"chat": { "id": ìˆ«ì }` í˜•íƒœë¥¼ ì°¾ê¸°
   ì´ ìˆ«ìê°€ **TELEGRAM\_CHAT\_ID**ì…ë‹ˆë‹¤.

---

### 2. Google ìº˜ë¦°ë”ì—ì„œ ì¼ì • í™•ì¸ ë° ìƒ˜í”Œ ì¶”ê°€

1. [https://calendar.google.com](https://calendar.google.com) ì— ì ‘ì†
2. ì˜¤ëŠ˜ ë‚ ì§œì— ì¼ì •ì´ ì—†ë‹¤ë©´, ì•„ë˜ì™€ ê°™ì´ ìƒ˜í”Œ ì¼ì • ì¶”ê°€

   * ì œëª©: íšŒì˜
   * ì‹œê°„: ì˜¤ì „ 10:00 \~ 11:00

   â€» Google ìº˜ë¦°ë”ì˜ ê¸°ë³¸ ìº˜ë¦°ë”ì— ì¶”ê°€í•´ì•¼ ì •ìƒ ì‘ë™í•©ë‹ˆë‹¤.

---

### 3. Google Apps Script ì—´ê¸°

1. [https://script.new](https://script.new) ì— ì ‘ì†í•´ ìƒˆ í”„ë¡œì íŠ¸ ìƒì„±
2. ì•„ë˜ ì½”ë“œë¥¼ ë¶™ì—¬ë„£ê¸°

```javascript
const TELEGRAM_TOKEN = 'ì—¬ê¸°ì—_ë´‡_í† í°';
const TELEGRAM_CHAT_ID = 'ì—¬ê¸°ì—_Chat_ID';
const OPENAI_API_KEY = 'ì—¬ê¸°ì—_OpenAI_API_KEY';


function sendDailySummary() {
  const events = getTodayCalendarEvents();
  const plainText = formatEvents(events);
  const summary = summarizeWithGPT(plainText);
  sendToTelegram(summary);
}

// ì˜¤ëŠ˜ ì¼ì • ê°€ì ¸ì˜¤ê¸°
function getTodayCalendarEvents() {
  const calendar = CalendarApp.getDefaultCalendar();
  const today = new Date();
  const start = new Date(today.setHours(0, 0, 0, 0));
  const end = new Date(today.setHours(23, 59, 59, 999));
  return calendar.getEvents(start, end);
}

// ì¼ì • ëª©ë¡ì„ ì‚¬ëŒì´ ì½ê¸° ì‰¬ìš´ í˜•íƒœë¡œ êµ¬ì„±
function formatEvents(events) {
  if (events.length === 0) return 'ì˜¤ëŠ˜ì€ ì¼ì •ì´ ì—†ìŠµë‹ˆë‹¤.';
  return events.map(e => {
    return `- ${e.getTitle()} (${formatTime(e.getStartTime())} ~ ${formatTime(e.getEndTime())})`;
  }).join('\n');
}

function formatTime(date) {
  return Utilities.formatDate(date, Session.getScriptTimeZone(), 'HH:mm');
}

// âœ… GPT í”„ë¡¬í”„íŠ¸ë¥¼ ë” ì¹œì ˆí•˜ê³  ìì—°ìŠ¤ëŸ½ê²Œ ìˆ˜ì •
function summarizeWithGPT(content) {
  const payload = {
    model: "gpt-4o", 
    messages: [
      {
        role: "system",
        content: "ë‹¹ì‹ ì€ ì‚¬ìš©ìì˜ ì¼ì • ë§¤ë‹ˆì €ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì˜¤ëŠ˜ ì¼ì •ì„ ë³´ê³ , ê°„ë‹¨í•˜ê³  ì¹œì ˆí•˜ê²Œ í•˜ë£¨ë¥¼ ì¤€ë¹„í•  ìˆ˜ ìˆë„ë¡ ì‘ì› ë©”ì‹œì§€ë„ í•¨ê»˜ ìš”ì•½í•´ì£¼ì„¸ìš”."
      },
      {
        role: "user",
        content: `ì˜¤ëŠ˜ì˜ ì¼ì •ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:\n\n${content}`
      }
    ],
    temperature: 0.7
  };

  const response = UrlFetchApp.fetch("https://api.openai.com/v1/chat/completions", {
    method: "post",
    contentType: "application/json",
    headers: {
      Authorization: `Bearer ${OPENAI_API_KEY}`
    },
    payload: JSON.stringify(payload)
  });

  const json = JSON.parse(response.getContentText());
  return json.choices[0].message.content.trim();
}

// âœ… ë©”ì‹œì§€ì— ìƒë‹¨ ì œëª© + í•˜ë‹¨ ì‘ì›ë§ ì¶”ê°€
function sendToTelegram(summary) {
  const today = Utilities.formatDate(new Date(), Session.getScriptTimeZone(), 'yyyyë…„ Mì›” dì¼ (E)');
  const fullMessage = `ğŸ“… *${today} ì¼ì • ìš”ì•½*\n\n${summary}\n\nì˜¤ëŠ˜ë„ ë©‹ì§„ í•˜ë£¨ ë³´ë‚´ì„¸ìš”! ğŸŒŸ`;

  const url = `https://api.telegram.org/bot${TELEGRAM_TOKEN}/sendMessage`;
  const payload = {
    chat_id: TELEGRAM_CHAT_ID,
    text: fullMessage,
    parse_mode: "Markdown"
  };

  UrlFetchApp.fetch(url, {
    method: "post",
    contentType: "application/json",
    payload: JSON.stringify(payload)
  });
}
```

---

### 4. íŠ¸ë¦¬ê±° ì„¤ì • (ì„ íƒ ì‚¬í•­)

1. ìƒë‹¨ ë©”ë‰´ â†’ **ì‹œê³„ ì•„ì´ì½˜(íŠ¸ë¦¬ê±°)** í´ë¦­
2. `sendDailySummary` í•¨ìˆ˜ ì„ íƒ
3. ì‹œê°„ ê¸°ë°˜ â†’ ë§¤ì¼ ì•„ì¹¨ ì›í•˜ëŠ” ì‹œê°„ ì„¤ì •

